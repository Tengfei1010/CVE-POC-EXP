Short Description
OneDriveSetup.exe improperly handles C:\Windows\Temp\aria-debug-{pid}.log file leads to Arbitrary File overwrite.

Vulnerability type
Elevation of privilege

Platform
Tested on Windows 10, Version 1909.18363.628.

Summary
OneDriveSetup.exe is the command line tool for setting up Microsoft OneDrive Application. 
It will be triggered to run as SYSTEM privilege account when OneDrive performs the setup procedure.
Command Line: "C:\Program Files (x86)\Microsoft OneDrive\19.222.1110.0006\OneDriveSetup.exe" /update /restart /allusers /updateSource:ODSU
When the command line runs, it will create/overwrite C:\Windows\Temp\aria-debug-{pid}.log using its process id.

Description
The file write op to C:\Windows\TEMP\aria-debug-{pid}.log doesn't include any kind of check for the target file, 
thus a standard user can turn the file into hardlink to achieve arbitrary file overwrite. The only problem here 
is the prediction of pid. The pid can be acquired by setting an opportunistic lock on files OneDriveStandaloneUpdater 
will access before it write contents into C:\Windows\TEMP\aria-debug-{pid}.log, here for demonstration, the poc creates
1000 target files under C:\test, then set 1000 hardlinks from C:\Windows\TEMP\aria-debug-{number}.log pointing at them.
The number 1000 can be increased to cover all possible pid range.

Steps to Reproduce
1. execute run.bat as normal user
2. trigger OneDriveStandaloneUpdater.exe to run as SYSTEM by hand or wait until OneDrive's update
3. 

Expected Result:
Files under C:\test remains unchanged.

Actual Result:
One of the target file under C:\test is overwritten.

Acknowledgement
Zhiniang Peng (@edwardzpeng) of Qihoo 360 Core security and Fangming Gu (@afang5472)